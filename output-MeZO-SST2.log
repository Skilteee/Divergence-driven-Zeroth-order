MODEL=facebook/opt-2.7b TASK=SST2 MODE=ft LR=1e-6 EPS=1e-3 STEPS=4000 bash mezo.sh
mezo-ft-4000-16-1e-6-1e-3-26
BS: 16
LR: 1e-6
EPS: 1e-3
SEED: 26
TRAIN/EVAL STEPS: 4000/500
MODE: ft
Extra args:
2025-01-03 16:00:21.941889: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-01-03 16:00:21.944110: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-01-03 16:00:21.949006: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1741035621.957175 1071273 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1741035621.959481 1071273 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-01-03 16:00:21.967735: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-01-03 16:00:22,678 - INFO - Note: NumExpr detected 32 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-01-03 16:00:22,678 - INFO - NumExpr defaulting to 16 threads.
2025-01-03 16:00:22,745 - INFO - PyTorch version 2.4.0+cu118 available.
2025-01-03 16:00:22,745 - INFO - TensorFlow version 2.18.0 available.
2025-01-03 16:00:22,745 - INFO - JAX version 0.4.35 available.
2025-01-03 16:00:25,592 - INFO - Loading model with FP16...
2025-01-03 16:00:29,162 - INFO - Done with 3.57s
2025-01-03 16:00:29,185 - INFO - Tokenizing training samples...
2025-01-03 16:00:29,628 - INFO - Done with 0.44s
2025-01-03 16:00:31,577 - INFO - ***** Running training *****
2025-01-03 16:00:31,577 - INFO -   Num examples = 1000
2025-01-03 16:00:31,577 - INFO -   Num Epochs = 64
2025-01-03 16:00:31,577 - INFO -   Instantaneous batch size per device = 16
2025-01-03 16:00:31,577 - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 16
2025-01-03 16:00:31,577 - INFO -   Gradient Accumulation steps = 1
2025-01-03 16:00:31,577 - INFO -   Total optimization steps = 4000
2025-01-03 16:00:31,577 - INFO -   Number of trainable parameters = 2651596800
  1%|██▎                                                                                                                                                                                         | 50/4000 [00:11<15:30,  4.24it/s]2025-01-03 16:00:43,492 - INFO - {'loss': 1.29, 'epoch': 0, 'lr': 9.938749999999999e-07}
  2%|████▋                                                                                                                                                                                      | 100/4000 [00:23<15:30,  4.19it/s]2025-01-03 16:00:55,230 - INFO - {'loss': 0.7017, 'epoch': 1, 'lr': 9.87625e-07}
2025-01-03 16:01:04,487 - INFO - Eval results: {'accuracy': 0.58, 'global_step': 100}
2025-01-03 16:01:04,488 - INFO - Best dev result: 0.58
  4%|███████                                                                                                                                                                                    | 150/4000 [00:46<15:07,  4.24it/s]2025-01-03 16:01:17,652 - INFO - {'loss': 0.8057, 'epoch': 2, 'lr': 9.81375e-07}
  5%|█████████▎                                                                                                                                                                                 | 200/4000 [00:57<15:27,  4.10it/s]2025-01-03 16:01:29,463 - INFO - {'loss': 0.8862, 'epoch': 3, 'lr': 9.75125e-07}
2025-01-03 16:01:38,712 - INFO - Eval results: {'accuracy': 0.614, 'global_step': 200}
2025-01-03 16:01:38,713 - INFO - Best dev result: 0.614
  6%|███████████▋                                                                                                                                                                               | 250/4000 [01:20<14:58,  4.17it/s]2025-01-03 16:01:52,140 - INFO - {'loss': 0.7515, 'epoch': 3, 'lr': 9.688749999999999e-07}
  8%|██████████████                                                                                                                                                                             | 300/4000 [01:32<14:37,  4.21it/s]2025-01-03 16:02:04,079 - INFO - {'loss': 0.5908, 'epoch': 4, 'lr': 9.62625e-07}
2025-01-03 16:02:13,333 - INFO - Eval results: {'accuracy': 0.66, 'global_step': 300}
2025-01-03 16:02:13,333 - INFO - Best dev result: 0.66
  9%|████████████████▎                                                                                                                                                                          | 350/4000 [01:54<14:40,  4.14it/s]2025-01-03 16:02:26,067 - INFO - {'loss': 0.6323, 'epoch': 5, 'lr': 9.56375e-07}
 10%|██████████████████▋                                                                                                                                                                        | 400/4000 [02:06<14:16,  4.21it/s]2025-01-03 16:02:37,843 - INFO - {'loss': 0.5322, 'epoch': 6, 'lr': 9.50125e-07}
2025-01-03 16:02:47,101 - INFO - Eval results: {'accuracy': 0.734, 'global_step': 400}
2025-01-03 16:02:47,101 - INFO - Best dev result: 0.734
 11%|█████████████████████                                                                                                                                                                      | 450/4000 [02:28<14:57,  3.95it/s]2025-01-03 16:03:00,108 - INFO - {'loss': 0.4788, 'epoch': 7, 'lr': 9.43875e-07}
 12%|███████████████████████▍                                                                                                                                                                   | 500/4000 [02:40<13:54,  4.19it/s]2025-01-03 16:03:12,047 - INFO - {'loss': 0.811, 'epoch': 7, 'lr': 9.37625e-07}
2025-01-03 16:03:21,301 - INFO - Eval results: {'accuracy': 0.774, 'global_step': 500}
2025-01-03 16:03:21,301 - INFO - Best dev result: 0.774
 14%|█████████████████████████▋                                                                                                                                                                 | 550/4000 [03:02<13:22,  4.30it/s]2025-01-03 16:03:33,820 - INFO - {'loss': 0.4771, 'epoch': 8, 'lr': 9.313749999999999e-07}
 15%|████████████████████████████                                                                                                                                                               | 600/4000 [03:14<13:19,  4.25it/s]2025-01-03 16:03:45,770 - INFO - {'loss': 0.5054, 'epoch': 9, 'lr': 9.251249999999999e-07}
2025-01-03 16:03:55,027 - INFO - Eval results: {'accuracy': 0.81, 'global_step': 600}
2025-01-03 16:03:55,027 - INFO - Best dev result: 0.81
 16%|██████████████████████████████▍                                                                                                                                                            | 650/4000 [03:36<13:19,  4.19it/s]2025-01-03 16:04:07,654 - INFO - {'loss': 0.5801, 'epoch': 10, 'lr': 9.18875e-07}
 18%|████████████████████████████████▋                                                                                                                                                          | 700/4000 [03:48<13:50,  3.97it/s]2025-01-03 16:04:19,739 - INFO - {'loss': 0.2844, 'epoch': 11, 'lr': 9.12625e-07}
2025-01-03 16:04:28,996 - INFO - Eval results: {'accuracy': 0.834, 'global_step': 700}
2025-01-03 16:04:28,996 - INFO - Best dev result: 0.834
 19%|███████████████████████████████████                                                                                                                                                        | 750/4000 [04:09<13:04,  4.14it/s]2025-01-03 16:04:41,563 - INFO - {'loss': 0.5884, 'epoch': 11, 'lr': 9.06375e-07}
 20%|█████████████████████████████████████▍                                                                                                                                                     | 800/4000 [04:21<13:56,  3.83it/s]2025-01-03 16:04:53,541 - INFO - {'loss': 0.3599, 'epoch': 12, 'lr': 9.001249999999999e-07}
2025-01-03 16:05:02,802 - INFO - Eval results: {'accuracy': 0.848, 'global_step': 800}
2025-01-03 16:05:02,802 - INFO - Best dev result: 0.848
 21%|███████████████████████████████████████▋                                                                                                                                                   | 850/4000 [04:43<13:09,  3.99it/s]2025-01-03 16:05:15,319 - INFO - {'loss': 0.3733, 'epoch': 13, 'lr': 8.93875e-07}
 22%|██████████████████████████████████████████                                                                                                                                                 | 900/4000 [04:55<12:11,  4.24it/s]2025-01-03 16:05:27,337 - INFO - {'loss': 0.6035, 'epoch': 14, 'lr': 8.876249999999999e-07}
2025-01-03 16:05:36,591 - INFO - Eval results: {'accuracy': 0.848, 'global_step': 900}
2025-01-03 16:05:36,591 - INFO - Best dev result: 0.848
 24%|████████████████████████████████████████████▍                                                                                                                                              | 950/4000 [05:17<12:10,  4.17it/s]2025-01-03 16:05:49,102 - INFO - {'loss': 0.3887, 'epoch': 15, 'lr': 8.81375e-07}
 25%|██████████████████████████████████████████████▌                                                                                                                                           | 1000/4000 [05:29<11:58,  4.17it/s]2025-01-03 16:06:01,064 - INFO - {'loss': 0.4736, 'epoch': 15, 'lr': 8.75125e-07}
2025-01-03 16:06:10,318 - INFO - Eval results: {'accuracy': 0.864, 'global_step': 1000}
2025-01-03 16:06:10,318 - INFO - Best dev result: 0.864
 26%|████████████████████████████████████████████████▊                                                                                                                                         | 1050/4000 [05:51<11:50,  4.15it/s]2025-01-03 16:06:22,812 - INFO - {'loss': 0.3489, 'epoch': 16, 'lr': 8.68875e-07}
 28%|███████████████████████████████████████████████████▏                                                                                                                                      | 1100/4000 [06:03<11:47,  4.10it/s]2025-01-03 16:06:34,699 - INFO - {'loss': 0.4248, 'epoch': 17, 'lr': 8.62625e-07}
2025-01-03 16:06:43,952 - INFO - Eval results: {'accuracy': 0.864, 'global_step': 1100}
2025-01-03 16:06:43,952 - INFO - Best dev result: 0.864
 29%|█████████████████████████████████████████████████████▍                                                                                                                                    | 1150/4000 [06:24<11:30,  4.13it/s]2025-01-03 16:06:56,260 - INFO - {'loss': 0.2515, 'epoch': 18, 'lr': 8.563749999999999e-07}
 30%|███████████████████████████████████████████████████████▊                                                                                                                                  | 1200/4000 [06:36<11:08,  4.19it/s]2025-01-03 16:07:08,196 - INFO - {'loss': 0.2771, 'epoch': 19, 'lr': 8.50125e-07}
2025-01-03 16:07:17,444 - INFO - Eval results: {'accuracy': 0.868, 'global_step': 1200}
2025-01-03 16:07:17,444 - INFO - Best dev result: 0.868
 31%|██████████████████████████████████████████████████████████▏                                                                                                                               | 1250/4000 [06:58<10:53,  4.21it/s]2025-01-03 16:07:29,854 - INFO - {'loss': 0.5078, 'epoch': 19, 'lr': 8.438749999999999e-07}
 32%|████████████████████████████████████████████████████████████▍                                                                                                                             | 1300/4000 [07:10<10:44,  4.19it/s]2025-01-03 16:07:41,688 - INFO - {'loss': 0.2578, 'epoch': 20, 'lr': 8.37625e-07}
2025-01-03 16:07:50,946 - INFO - Eval results: {'accuracy': 0.872, 'global_step': 1300}
2025-01-03 16:07:50,946 - INFO - Best dev result: 0.872
 34%|██████████████████████████████████████████████████████████████▊                                                                                                                           | 1350/4000 [07:31<10:20,  4.27it/s]2025-01-03 16:08:03,183 - INFO - {'loss': 0.2861, 'epoch': 21, 'lr': 8.313749999999999e-07}
 35%|█████████████████████████████████████████████████████████████████                                                                                                                         | 1400/4000 [07:43<10:25,  4.16it/s]2025-01-03 16:08:15,057 - INFO - {'loss': 0.2061, 'epoch': 22, 'lr': 8.25125e-07}
2025-01-03 16:08:24,317 - INFO - Eval results: {'accuracy': 0.87, 'global_step': 1400}
 36%|███████████████████████████████████████████████████████████████████▍                                                                                                                      | 1450/4000 [08:04<09:43,  4.37it/s]2025-01-03 16:08:36,103 - INFO - {'loss': 0.2252, 'epoch': 23, 'lr': 8.18875e-07}
 38%|█████████████████████████████████████████████████████████████████████▊                                                                                                                    | 1500/4000 [08:16<09:48,  4.25it/s]2025-01-03 16:08:47,918 - INFO - {'loss': 0.2001, 'epoch': 23, 'lr': 8.126249999999999e-07}
2025-01-03 16:08:57,168 - INFO - Eval results: {'accuracy': 0.882, 'global_step': 1500}
2025-01-03 16:08:57,168 - INFO - Best dev result: 0.882
 39%|████████████████████████████████████████████████████████████████████████                                                                                                                  | 1550/4000 [08:38<09:32,  4.28it/s]2025-01-03 16:09:09,762 - INFO - {'loss': 0.3457, 'epoch': 24, 'lr': 8.063750000000001e-07}
 40%|██████████████████████████████████████████████████████████████████████████▍                                                                                                               | 1600/4000 [08:49<09:24,  4.25it/s]2025-01-03 16:09:21,482 - INFO - {'loss': 0.3015, 'epoch': 25, 'lr': 8.001249999999999e-07}
2025-01-03 16:09:30,739 - INFO - Eval results: {'accuracy': 0.898, 'global_step': 1600}
2025-01-03 16:09:30,740 - INFO - Best dev result: 0.898
 41%|████████████████████████████████████████████████████████████████████████████▋                                                                                                             | 1650/4000 [09:11<09:25,  4.15it/s]2025-01-03 16:09:43,062 - INFO - {'loss': 0.2756, 'epoch': 26, 'lr': 7.93875e-07}
 42%|███████████████████████████████████████████████████████████████████████████████                                                                                                           | 1700/4000 [09:23<09:08,  4.19it/s]2025-01-03 16:09:55,085 - INFO - {'loss': 0.3506, 'epoch': 26, 'lr': 7.876249999999999e-07}
2025-01-03 16:10:04,345 - INFO - Eval results: {'accuracy': 0.9, 'global_step': 1700}
2025-01-03 16:10:04,346 - INFO - Best dev result: 0.9
 44%|█████████████████████████████████████████████████████████████████████████████████▍                                                                                                        | 1750/4000 [09:45<09:00,  4.16it/s]2025-01-03 16:10:16,866 - INFO - {'loss': 0.2076, 'epoch': 27, 'lr': 7.813749999999999e-07}
 45%|███████████████████████████████████████████████████████████████████████████████████▋                                                                                                      | 1800/4000 [09:57<08:33,  4.28it/s]2025-01-03 16:10:28,623 - INFO - {'loss': 0.1626, 'epoch': 28, 'lr': 7.751250000000001e-07}
2025-01-03 16:10:37,875 - INFO - Eval results: {'accuracy': 0.902, 'global_step': 1800}
2025-01-03 16:10:37,875 - INFO - Best dev result: 0.902
 46%|██████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 1850/4000 [10:18<08:49,  4.06it/s]2025-01-03 16:10:50,229 - INFO - {'loss': 0.2118, 'epoch': 29, 'lr': 7.688749999999999e-07}
 48%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                 | 1900/4000 [10:30<08:16,  4.23it/s]2025-01-03 16:11:02,049 - INFO - {'loss': 0.2563, 'epoch': 30, 'lr': 7.62625e-07}
2025-01-03 16:11:11,296 - INFO - Eval results: {'accuracy': 0.904, 'global_step': 1900}
2025-01-03 16:11:11,296 - INFO - Best dev result: 0.904
 49%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                               | 1950/4000 [10:52<08:04,  4.23it/s]2025-01-03 16:11:23,732 - INFO - {'loss': 0.2412, 'epoch': 30, 'lr': 7.56375e-07}
 50%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                                             | 2000/4000 [11:04<08:01,  4.15it/s]2025-01-03 16:11:35,771 - INFO - {'loss': 0.374, 'epoch': 31, 'lr': 7.501249999999999e-07}
2025-01-03 16:11:45,025 - INFO - Eval results: {'accuracy': 0.904, 'global_step': 2000}
2025-01-03 16:11:45,025 - INFO - Best dev result: 0.904
 51%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 2050/4000 [11:25<07:35,  4.28it/s]2025-01-03 16:11:57,068 - INFO - {'loss': 0.2009, 'epoch': 32, 'lr': 7.43875e-07}
 52%|█████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                        | 2100/4000 [11:37<07:40,  4.13it/s]2025-01-03 16:12:08,981 - INFO - {'loss': 0.4609, 'epoch': 33, 'lr': 7.37625e-07}
2025-01-03 16:12:18,241 - INFO - Eval results: {'accuracy': 0.904, 'global_step': 2100}
2025-01-03 16:12:18,241 - INFO - Best dev result: 0.904
 54%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                      | 2150/4000 [11:58<07:18,  4.22it/s]2025-01-03 16:12:30,410 - INFO - {'loss': 0.1755, 'epoch': 34, 'lr': 7.313749999999999e-07}
 55%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 2200/4000 [12:10<07:01,  4.27it/s]2025-01-03 16:12:42,377 - INFO - {'loss': 0.385, 'epoch': 34, 'lr': 7.25125e-07}
2025-01-03 16:12:51,637 - INFO - Eval results: {'accuracy': 0.906, 'global_step': 2200}
2025-01-03 16:12:51,637 - INFO - Best dev result: 0.906
 56%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 2250/4000 [12:32<06:49,  4.27it/s]2025-01-03 16:13:04,025 - INFO - {'loss': 0.2644, 'epoch': 35, 'lr': 7.188749999999999e-07}
 57%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                               | 2300/4000 [12:44<06:56,  4.08it/s]2025-01-03 16:13:15,992 - INFO - {'loss': 0.3376, 'epoch': 36, 'lr': 7.12625e-07}
2025-01-03 16:13:25,231 - INFO - Eval results: {'accuracy': 0.904, 'global_step': 2300}
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                            | 2350/4000 [13:05<06:19,  4.35it/s]2025-01-03 16:13:36,993 - INFO - {'loss': 0.1605, 'epoch': 37, 'lr': 7.06375e-07}
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                          | 2400/4000 [13:17<06:12,  4.30it/s]2025-01-03 16:13:48,978 - INFO - {'loss': 0.234, 'epoch': 38, 'lr': 7.001249999999999e-07}
2025-01-03 16:13:58,214 - INFO - Eval results: {'accuracy': 0.906, 'global_step': 2400}
2025-01-03 16:13:58,214 - INFO - Best dev result: 0.906
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                        | 2450/4000 [13:38<06:23,  4.04it/s]2025-01-03 16:14:10,491 - INFO - {'loss': 0.1129, 'epoch': 38, 'lr': 6.93875e-07}
 62%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                     | 2500/4000 [13:50<06:01,  4.15it/s]2025-01-03 16:14:22,386 - INFO - {'loss': 0.209, 'epoch': 39, 'lr': 6.876249999999999e-07}
2025-01-03 16:14:31,634 - INFO - Eval results: {'accuracy': 0.91, 'global_step': 2500}
2025-01-03 16:14:31,635 - INFO - Best dev result: 0.91
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                   | 2550/4000 [14:12<05:35,  4.33it/s]2025-01-03 16:14:44,002 - INFO - {'loss': 0.2539, 'epoch': 40, 'lr': 6.81375e-07}
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 2600/4000 [14:24<05:16,  4.42it/s]2025-01-03 16:14:55,700 - INFO - {'loss': 0.1115, 'epoch': 41, 'lr': 6.75125e-07}
2025-01-03 16:15:04,959 - INFO - Eval results: {'accuracy': 0.914, 'global_step': 2600}
2025-01-03 16:15:04,959 - INFO - Best dev result: 0.914
 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 2650/4000 [14:45<05:21,  4.20it/s]2025-01-03 16:15:17,360 - INFO - {'loss': 0.1425, 'epoch': 42, 'lr': 6.68875e-07}
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                            | 2700/4000 [14:57<05:07,  4.22it/s]2025-01-03 16:15:29,280 - INFO - {'loss': 0.1335, 'epoch': 42, 'lr': 6.62625e-07}
2025-01-03 16:15:38,505 - INFO - Eval results: {'accuracy': 0.914, 'global_step': 2700}
2025-01-03 16:15:38,506 - INFO - Best dev result: 0.914
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 2750/4000 [15:19<05:01,  4.15it/s]2025-01-03 16:15:50,817 - INFO - {'loss': 0.0488, 'epoch': 43, 'lr': 6.563749999999999e-07}
 70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 2800/4000 [15:31<04:58,  4.02it/s]2025-01-03 16:16:02,632 - INFO - {'loss': 0.1378, 'epoch': 44, 'lr': 6.501250000000001e-07}
2025-01-03 16:16:11,888 - INFO - Eval results: {'accuracy': 0.92, 'global_step': 2800}
2025-01-03 16:16:11,888 - INFO - Best dev result: 0.92
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 2850/4000 [15:52<04:23,  4.37it/s]2025-01-03 16:16:24,100 - INFO - {'loss': 0.2827, 'epoch': 45, 'lr': 6.438749999999999e-07}
 72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                   | 2900/4000 [16:04<03:57,  4.64it/s]2025-01-03 16:16:35,903 - INFO - {'loss': 0.408, 'epoch': 46, 'lr': 6.37625e-07}
2025-01-03 16:16:45,161 - INFO - Eval results: {'accuracy': 0.914, 'global_step': 2900}
 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                | 2950/4000 [16:25<04:06,  4.25it/s]2025-01-03 16:16:57,127 - INFO - {'loss': 0.4004, 'epoch': 46, 'lr': 6.31375e-07}
 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                              | 3000/4000 [16:37<04:03,  4.11it/s]2025-01-03 16:17:09,024 - INFO - {'loss': 0.0914, 'epoch': 47, 'lr': 6.251249999999999e-07}
2025-01-03 16:17:18,279 - INFO - Eval results: {'accuracy': 0.916, 'global_step': 3000}
 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                            | 3050/4000 [16:58<03:59,  3.97it/s]2025-01-03 16:17:30,015 - INFO - {'loss': 0.1154, 'epoch': 48, 'lr': 6.188750000000001e-07}
 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 3100/4000 [17:10<03:39,  4.11it/s]2025-01-03 16:17:41,900 - INFO - {'loss': 0.182, 'epoch': 49, 'lr': 6.126249999999999e-07}
2025-01-03 16:17:51,156 - INFO - Eval results: {'accuracy': 0.92, 'global_step': 3100}
2025-01-03 16:17:51,156 - INFO - Best dev result: 0.92
 79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 3150/4000 [17:31<03:08,  4.50it/s]2025-01-03 16:18:03,319 - INFO - {'loss': 0.1145, 'epoch': 49, 'lr': 6.06375e-07}
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                     | 3200/4000 [17:43<03:05,  4.30it/s]2025-01-03 16:18:15,259 - INFO - {'loss': 0.1265, 'epoch': 50, 'lr': 6.00125e-07}
2025-01-03 16:18:24,530 - INFO - Eval results: {'accuracy': 0.918, 'global_step': 3200}
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                  | 3250/4000 [18:04<03:00,  4.16it/s]2025-01-03 16:18:36,500 - INFO - {'loss': 0.5229, 'epoch': 51, 'lr': 5.938749999999999e-07}
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 3300/4000 [18:16<02:45,  4.23it/s]2025-01-03 16:18:48,323 - INFO - {'loss': 0.1829, 'epoch': 52, 'lr': 5.87625e-07}
2025-01-03 16:18:57,587 - INFO - Eval results: {'accuracy': 0.918, 'global_step': 3300}
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 3350/4000 [18:37<02:36,  4.15it/s]2025-01-03 16:19:09,362 - INFO - {'loss': 0.4417, 'epoch': 53, 'lr': 5.813749999999999e-07}
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 3400/4000 [18:49<02:24,  4.15it/s]2025-01-03 16:19:21,332 - INFO - {'loss': 0.1415, 'epoch': 53, 'lr': 5.75125e-07}
2025-01-03 16:19:30,594 - INFO - Eval results: {'accuracy': 0.922, 'global_step': 3400}
2025-01-03 16:19:30,594 - INFO - Best dev result: 0.922
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 3450/4000 [19:11<02:12,  4.16it/s]2025-01-03 16:19:42,874 - INFO - {'loss': 0.0793, 'epoch': 54, 'lr': 5.68875e-07}
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 3500/4000 [19:23<01:54,  4.38it/s]2025-01-03 16:19:54,635 - INFO - {'loss': 0.1559, 'epoch': 55, 'lr': 5.626249999999999e-07}
2025-01-03 16:20:03,897 - INFO - Eval results: {'accuracy': 0.916, 'global_step': 3500}
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                     | 3550/4000 [19:44<01:45,  4.27it/s]2025-01-03 16:20:15,910 - INFO - {'loss': 0.0861, 'epoch': 56, 'lr': 5.56375e-07}
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 3600/4000 [19:56<01:36,  4.13it/s]2025-01-03 16:20:27,691 - INFO - {'loss': 0.4048, 'epoch': 57, 'lr': 5.50125e-07}
2025-01-03 16:20:36,947 - INFO - Eval results: {'accuracy': 0.916, 'global_step': 3600}
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                | 3650/4000 [20:17<01:28,  3.94it/s]2025-01-03 16:20:48,801 - INFO - {'loss': 0.1782, 'epoch': 57, 'lr': 5.438749999999999e-07}
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 3700/4000 [20:28<01:10,  4.24it/s]2025-01-03 16:21:00,522 - INFO - {'loss': 0.2852, 'epoch': 58, 'lr': 5.37625e-07}
2025-01-03 16:21:09,776 - INFO - Eval results: {'accuracy': 0.918, 'global_step': 3700}
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍           | 3750/4000 [20:49<00:56,  4.41it/s]2025-01-03 16:21:21,579 - INFO - {'loss': 0.2615, 'epoch': 59, 'lr': 5.31375e-07}
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 3800/4000 [21:01<00:46,  4.30it/s]2025-01-03 16:21:33,582 - INFO - {'loss': 0.3997, 'epoch': 60, 'lr': 5.25125e-07}
2025-01-03 16:21:42,840 - INFO - Eval results: {'accuracy': 0.918, 'global_step': 3800}
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 3850/4000 [21:23<00:35,  4.18it/s]2025-01-03 16:21:54,740 - INFO - {'loss': 0.1372, 'epoch': 61, 'lr': 5.18875e-07}
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 3900/4000 [21:34<00:24,  4.05it/s]2025-01-03 16:22:06,513 - INFO - {'loss': 0.1696, 'epoch': 61, 'lr': 5.12625e-07}
2025-01-03 16:22:15,774 - INFO - Eval results: {'accuracy': 0.924, 'global_step': 3900}
2025-01-03 16:22:15,774 - INFO - Best dev result: 0.924
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 3950/4000 [21:56<00:11,  4.40it/s]2025-01-03 16:22:27,930 - INFO - {'loss': 0.144, 'epoch': 62, 'lr': 5.06375e-07}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4000/4000 [22:08<00:00,  4.35it/s]2025-01-03 16:22:39,936 - INFO - {'loss': 0.5254, 'epoch': 63, 'lr': 5.001249999999999e-07}
2025-01-03 16:22:49,168 - INFO - Eval results: {'accuracy': 0.916, 'global_step': 4000}
2025-01-03 16:22:49,168 - INFO -

Training completed. Do not forget to share your model on huggingface.co/models =)


{'train_runtime': 1337.591, 'train_samples_per_second': 47.847, 'train_steps_per_second': 2.99, 'train_loss': 0.33786114501953124, 'epoch': 63.49}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4000/4000 [22:17<00:00,  2.99it/s]
2025-01-03 16:22:49,169 - INFO - There are 0 training samples and 500 validation samples
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 54.11it/s]
2025-01-03 16:22:58,410 - INFO - ===== Train set 26 =====
2025-01-03 16:22:58,410 - INFO - {'accuracy': 0.916}